# include global config

. "${ORGCODEDIR}/datadir.conf"

# include vm utility functions

. "${ORGCODEDIR}/external_libraries/functions/vm_functions.bash"

# include mount-partition

. "${ORGCODEDIR}/external_libraries/mount-partition/mount-partition.sh" "load"

level="node"

idx=${1:-10}

# host settings
NETWORK="10.0.2.0"
BRIDGE_NAME="1box-br-${idx}"
# required by vm_functions.bash

# IP_ADDR="${NETWORK%.*}.10"
SSH_KEY="${LINKCODEDIR}/1box-key"
TMP_ROOT="${LINKCODEDIR}/tmp_root"

# old 1box
IP_ADDR=10.0.2.15
BRIDGE_NAME=vboxbr0
# vm specs
format="raw"
vm_image="${LINKCODEDIR}/box-disk1.raw"
arch="x86_64"
vm_name="vdc-1box"
cpu_type="qemu64,+vmx"
mem_size=2048
cpu_num=1
vnc_addr="127.0.0.1"
vnc_port=$(( 11050 + idx ))
serial=telnet:127.0.0.1:$(( 14050 + idx )),server,nowait
edge_networking="netfilter"
nics[0]="ifname=onebox-${idx} hwaddr=02:00:00:00:00:${idx} bridge=${BRIDGE_NAME}"

# base packages

include_packages=(
    "man"
    "ntp"
    "ntpdate"
    "sudo"
    "rsync"
    "git"
    "make"
    "vim-minimal"
    "screen"
    "nmap"
    "lsof"
    "strace"
    "tcpdump"
    "traceroute"
    "telnet"
    "ltrace"
    "bind-utils"
    "sysstat"
    "nc"
    "wireshark"
    "httpd"
    "gcc"
    "keepalived"
)

#n wakame config

vdc_hypervisor="openvz"
vdc_package=(
    # full pkg name: wakame-vdc-<pkg name>-vmapp-config
    "dcmgr"
    "example-1box-dcmgr"
    "sta"
    "example-1box-sta"
    "bksta"
    "natbox"
    "dolphin"
    "nwmongw"
    "webui"
    "example-1box-webui"
    "admin"
    "example-1box-admin"
)

# zabbix config

zabbix_version=1.8.16-1.el6
zabbix_package=(
    "zabbix"
    "zabbix-server"
    "zabbix-server-mysql"
    "zabbix-web"
#    "zabbix-web-mysql"
    "zabbix-agent"
)

# fluentd config
fluentd_version=1.1.13
